<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>Vectors</title>
		<style>
			body { margin: 0; overflow: hidden}
			canvas {
				border: solid black 1px;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas" width="1800" height="800"></canvas>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="./functions.js"></script>
		<script src="./vector.js"></script>
		<script>
			var canvas = document.getElementById("canvas");
			var ctx = canvas.getContext("2d");

			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;

			$(window).resize(function () {
				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;
			})

			var mouseX, mouseY;
			var mouse = new Vector(mouseX, mouseY);
			var coord = new Vector(50, 50);
			var velocity = new Vector(1, 3.3);

			var Mover = function () {
				this.location = new Vector(Math.floor(Math.random() * canvas.width), Math.floor(Math.random() * canvas.height));
				this.velocity = new Vector();
				this.acceleration = new Vector();
			}

			Mover.prototype.update = function () {
				var mouse = new Vector(mouseX, mouseY);

				var dir = mouse.copy();
				dir.sub(this.location);

				dir.normalize();
				dir.div(2);

				this.acceleration = dir;

				this.velocity.add(this.acceleration);
				this.velocity.limit(10);

				this.location.add(this.velocity);
			}

			Mover.prototype.checkEdges = function () {
				if ((this.location.x > canvas.width) || (this.location.x < 0)) {
				    this.velocity.x = this.velocity.x * -1;
				}
				if ((this.location.y > canvas.height) || (this.location.y < 0)) {
				    this.velocity.y = this.velocity.y * -1;
				}
			}

			Mover.prototype.display = function () {
				drawCircle(this.location.x, this.location.y, 3);
			}

			var movers = [];

			for (var i = 0; i < 500; i++) {
				movers.push(new Mover());
			}

			function draw() {
				var mouse = new Vector(mouseX, mouseY);
				for(var i = 0; i < movers.length; i++) {
					movers[i].update();
					movers[i].checkEdges();
					movers[i].display();
					var dist = movers[i].location.copy();
				}
			}

			function loop() {
				coord.add(velocity);
				if ((coord.x > canvas.width) || (coord.x < 0)) {
				    velocity.x = velocity.x * -1;
				}
				if ((coord.y > canvas.height) || (coord.y < 0)) {
				    velocity.y = velocity.y * -1;
				}
			}

			setInterval(function () {
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				draw();
				var mouse = new Vector(mouseX, mouseY);
				drawCircle(mouse.x, mouse.y, 10)
			}, 1000/60)

			$(document).mousemove(function (e) {
				mouseX = e.offsetX;
				mouseY = e.offsetY;
			})
		</script>
	</body>
</html>